{% extends 'main.jinja' %}
{% load static %}
{% block content %}

<section class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-12 px-4">
  <div class="max-w-md mx-auto bg-white rounded-xl shadow-2xl overflow-hidden p-8">
    <div class="text-center mb-8">
      <h2 class="text-3xl font-bold text-gray-800 mb-2">Create Account</h2>
      <p class="text-gray-500">Join our community today</p>
    </div>


    <form class="space-y-6" method="post">
      <!-- Username -->
        {% csrf_token %}
      <div>
        <label class="block text-sm font-medium text-gray-600 mb-2">Username</label>
        <div class="relative">
        <input
            type="text"
            required
            name="username"
            id="username"
            value="{{ form.username.value }}"
            class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none">
          <svg class="absolute right-3 top-3.5 h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
        </div>
        {% if form.username.errors %}
            <div class="text-danger">
                {% for error in form.username.errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
      {% endif %}
      </div>

      <!-- Email -->
      <div>
        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
      <div class="relative">
          <input
            type="text"
            required
            name="email"
            id="email"
            value="{{ form.email.value }}"
            class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none">
          <svg class="absolute right-3 top-3.5 h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
        </div><!-- Renders the email field -->
        {% if form.email.errors %}
            <div class="text-danger">
                {% for error in form.email.errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
      {% endif %}
      </div>

      <!-- Password -->
      <div>
        <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
      <div class="relative">
          <input
            type="password"
            required
            name="password_hash"
            id="password_hash"
            value="{{ form.password_hash.value }}"
            class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none">
          <svg class="absolute right-3 top-3.5 h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
        </div><!-- Renders the email field -->
        {% if form.password_hash.errors %}
            <div class="text-danger">
                {% for error in form.password_hash.errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
      {% endif %}
      </div>

      <!-- Full Name -->
      <div>
        <label for="full_name" class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
      <input
          type="text"
            required
            name="full_name"
            id="full_name"
            value="{{ form.full_name.value }}"
          class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none"
          placeholder="John Doe">
<!-- Renders the email field -->
        {% if form.full_name.errors %}
            <div class="text-danger">
                {% for error in form.full_name.errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
      {% endif %}
      </div>

      <!-- Phone Number -->
      <div>
        <label for="phone_number" class="block text-sm font-medium text-gray-600 mb-2">Phone Number</label>
        <div class="relative">
          <input
            type="tel"
            pattern="[0-9]{10}"
            required
            name="phone_number"
            id="phone_number"
            value="{{ form.phone_number.value }}"
            class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none"
            placeholder="1234567890">
          <span class="absolute right-3 top-3.5 text-gray-400">+1</span>
        </div><!-- Renders the email field -->
        {% if form.phone_number.errors %}
            <div class="text-danger">
                {% for error in form.phone_number.errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
      {% endif %}
      </div>

      <!-- Account Status -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Account Status</label>
        <select
            required
            name="account_status"
            id="account_status"
                class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none appearance-none bg-white">
          <option value="">Select Status</option>
            <option value="Active" {% if form.account_status.value == "Active" %}selected{% endif %}>Active</option>
            <option value="Suspended" {% if form.account_status.value == "Suspended" %}selected{% endif %}>Suspended</option>
            <option value="Inactive" {% if form.account_status.value == "Inactive" %}selected{% endif %}>Inactive</option>
        </select>

  <!-- Renders the email field -->
        {% if form.account_status.errors %}
            <div class="text-danger">
                {% for error in form.account_status.errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
      {% endif %}
      </div>

      <!-- Submit Button -->
      <button
        type="submit"
        class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm
              text-sm font-medium text-white bg-blue-600 hover:bg-blue-700
              focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
        Create Account
      </button>
    </form>
  </div>
</section>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
    $('#email').on('change', function() {
        var email = $(this).val();
        $.ajax({
            url: '{% url "check_email" %}',
            data: {
                'email': email
            },
            dataType: 'json',
            success: function(data) {
                if (data.is_taken) {
                    alert("This email is already in use.");
                }
            }
        });
    });
});
</script>
{% endblock %}